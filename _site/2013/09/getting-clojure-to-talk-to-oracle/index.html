<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>The House of Ding</title>

    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
      <h1><a href="/">The House of Ding.</a></h1>
      <!--<p class="view"><a href="https://github.com/cdinger">View My GitHub Profile</a></p>-->
      </header>
      <section>


    <h2><a href="">Getting Clojure/Leiningen to talk to Oracle</a></h2>
    <p>06 Sep 2013</p>
    <p>I&#8217;ve just started learning Clojure and have been trying desperately to get my Leiningen project to talk to an Oracle database. All of my enterprise&#8217;s data is wrapped up in Oracle, so to do anyting useful or interesting with Clojure, I had to first overcome this first step.</p>

<p>The following is surely a no-brainer for experienced Java developers, but I come from Ruby and am new to both Java <em>and</em> Clojure. I hope this helps others coming into Clojure from this angle.</p>

<h2 id='download_oracle_jdbc_driver'>Download Oracle JDBC driver</h2>

<p>If you don&#8217;t already have an Oracle JDBC driver (ojdbc5.jar, ojdbc6.jar, ojdbc14.jar), you&#8217;ll want to <a href='http://www.oracle.com/technetwork/database/enterprise-edition/jdbc-112010-090769.html'>download it from Oracle</a> first.</p>

<h2 id='install_ojdbc_jar_to_local_maven_repository'>Install ojdbc jar to local Maven repository</h2>

<p>Install your JDBC driver to your local Maven repo with this command:</p>
<div class='highlight'><pre><code class='bash'>mvn install:install-file -X -DgroupId<span class='o'>=</span><span class='nb'>local</span> -DartifactId<span class='o'>=</span>ojdbc6 -Dversion<span class='o'>=</span>11.2.0.3 -Dpackaging<span class='o'>=</span>jar -Dfile<span class='o'>=</span>/opt/oracle/instantclient/ojdbc6.jar -DgeneratePom<span class='o'>=</span><span class='nb'>true</span>
</code></pre></div>
<p>Note a few things here:</p>

<ul>
<li><code>groupId</code>, which would normally be something like <code>com.oracle</code> is replaced with <code>local</code>. This can be anything you want; <code>self</code> or <code>poo</code> would work just as well.</li>

<li>Make sure <code>version</code> matches the version you downloaded from Oracle.</li>

<li><code>file</code> needs to point to an absolute path to your jar file. Relative paths don&#8217;t seem to work.</li>
</ul>

<h2 id='reference_your_local_respository_in_projectclj'>Reference your local respository in project.clj</h2>

<p>In your project.clj file, you can now specify your proprietary library as you would any other dependency. Just be sure to prefix it with the value you used for <code>groupId</code> in your maven command; <code>local</code> in this case:</p>
<div class='highlight'><pre><code class='clojure'>  <span class='ss'>:dependencies</span> <span class='p'>[[</span><span class='nv'>org.clojure/clojure</span> <span class='s'>&quot;1.5.1&quot;</span><span class='p'>]</span>
                 <span class='p'>[</span><span class='nv'>org.clojure/java.jdbc</span> <span class='s'>&quot;0.3.0-alpha4&quot;</span><span class='p'>]</span>
                 <span class='p'>[</span><span class='nv'>local/ojdbc6</span> <span class='s'>&quot;11.2.0.3&quot;</span><span class='p'>]</span>
</code></pre></div>
<h2 id='trying_it_out'>Trying it out</h2>

<p>Huzzah! My cheesy query now returns results:</p>
<div class='highlight'><pre><code class='clojure'><span class='p'>(</span><span class='nf'>require</span> <span class='o'>&#39;</span><span class='p'>[</span><span class='nv'>clojure.java.jdbc</span> <span class='ss'>:as</span> <span class='nv'>j</span><span class='p'>]</span>
         <span class='o'>&#39;</span><span class='p'>[</span><span class='nv'>clojure.java.jdbc.sql</span> <span class='ss'>:as</span> <span class='nv'>s</span><span class='p'>])</span>

<span class='p'>(</span><span class='k'>def </span><span class='nv'>db</span> <span class='p'>{</span><span class='ss'>:classname</span> <span class='s'>&quot;oracle.jdbc.driver.OracleDriver&quot;</span>
         <span class='ss'>:subprotocol</span> <span class='s'>&quot;oracle&quot;</span>
         <span class='ss'>:subname</span> <span class='s'>&quot;thin:@somehost:1521/some_service&quot;</span>
         <span class='ss'>:user</span> <span class='s'>&quot;some_user&quot;</span>
         <span class='ss'>:password</span> <span class='s'>&quot;some_pass&quot;</span><span class='p'>})</span>

<span class='p'>(</span><span class='nf'>j/query</span> <span class='nv'>db</span> <span class='p'>(</span><span class='nf'>s/select</span> <span class='nb'>* </span><span class='ss'>:dual</span><span class='p'>))</span>
</code></pre></div>
<p>Returns the familiar ol&#8217;:</p>
<div class='highlight'><pre><code class='clojure'><span class='p'>({</span><span class='ss'>:dummy</span> <span class='s'>&quot;X&quot;</span><span class='p'>})</span>
</code></pre></div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'houseofding'; // required: replace example with your forum shortname
        var disqus_identifier = '/2013/09/getting-clojure-to-talk-to-oracle'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
      </section>
      <footer>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/javascripts/scale.fix.js"></script>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'houseofding'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-297584-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>
</html>


